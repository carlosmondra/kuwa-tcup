<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<!-- Last updated by Jim Flynn on 2008-06-10 -->
	<!-- TODO: If it will still be compatible with Cordova and better than JQuery Mobile, convert this page to React. -->
	<!-- TODO: Merge this page into a Cordova project. Deploy on Android. -->
	<head>
		<!-- NOTE: Each developer who updates this file should add their name to the author list. -->
		<meta name="author" content="The Kuwa Foundation, Inc. (kuwa.org) - Hrishikesh Kashyap, Jim Flynn">
		<meta charset="utf-8">
		<meta name="format-detection" content="telephone=no">
		<meta name="msapplication-tap-highlight" content="no">
		<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
		<link rel="stylesheet" type="text/css" href="css/index.css">
		<link rel="stylesheet" type="text/css" href="css/base.css">
		<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
		<script type="text/javascript" src="js/keythereum.min.js"></script>
		<script type="text/javascript" src="js/main.js"></script>
		<script type="text/javascript">
		$(document).ready(function() {
			$('.field').val( '' );
			$('#showPassword').prop('checked', false);
			$('#password').prop('type', 'password');
		});
		</script>
		<title>Create Your Kuwa Identity</title>
	</head>
	<body>
	<img src="img/site-logo.png" style="margin-top: 10px;" />
	<h1>Create Your Kuwa Identity</h1>

	<div class="FormWrapper" id="key-info">
		<h2>STEP 1: Create a Private Key and an Address.</h2>
                <label for="key">Set Your Password:</label>
		<input type="password" id="password" class="field"/>
		<p>
			<input id="showPassword" type="checkbox" onclick="Javascript: togglePassword()">Show Password 
		</p>
                <button onclick="Javascript: processKeyGeneration();">Create Keys</button> 
		<div id="private-key-section" style="display: none; margin: 30px 30px 0px 30px; text-align: left;">
			<h2>Your Private Key:</h2>
		 	<p id="private-key"></p>
			<p><strong>IMPORTANT:</strong> Keep your private key and password secret. Remember your password.</p>
		</div>
	</div>
	<!-- TODO: Step 1 will also include getting the contract address and ABI from the Sponsor. We'll send those values to the StorageManager. -->
	<!-- End key-info -->

	<div class="FormWrapper" id="registration-info" style="display: none;">
		<h2>STEP 2: Submit Your Kuwa ID Request.</h2>
	    	<form style="margin: auto;" action="http://dev.kuwa.org:8080/StoreRegistrationRequest_war/rest/files/upload" method="post" enctype="multipart/form-data">  
			<p>  
				Select a File: <input type="file" name="file" size="45" />  
			</p>  
			<p>  
				Ethereum Address: <input class="field" type="text" name="address" id="address" size="45" />  
			</p>  
			<p>  
				Challenge Phrase: <input class="field"  type="text" name="challenge" id="challenge" size="45" />  
			</p> 
			<p>  
				Shared Secret: <input class="field"  type="text" name="secret" id="secret" size="45" />  
			</p> 
			<input type="submit" value="Upload Info" />
			<!-- TODO: For a later story, we will likely replace the shared secret with a stronger way to secure the link between the client and StorageManager (e.g., Use the private key to encrypt or sign the call.). -->
			<!-- NOTE: We probably don't need to send the challenge phrase and address since the StorageManager can retrieve those values from the Kuwa RegistrationRequest contract. -->
		</form> 
	</div>
	<!-- End registration-info -->

	<!-- Show this div when waiting for an asynchronous call to complete. -->
	<div id="loading">
		<div id="loading-dialog">
			<img src="img/loading.gif" alt="Loading.."/>
			<h2>Please wait...</h2>
		</div>
	</div>
	<!-- End loading -->

	<!-- TODO: A project stretch goal will be to add QR code scanning of other registrants' addresses to create a simple social graph. See Kuwa white paper for details. -->
	<!-- TODO: Another stretch goal will be to deploy iOS and Web versions of this app in addition to the Android app. -->
    </body>
</html>
