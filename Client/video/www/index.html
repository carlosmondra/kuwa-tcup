<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title></title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width">
        <link rel="stylesheet" type="text/css" href="css/index.css" />
	</head>
	<body>

		<button id="takeVideo">Take Video</button>
		<div id="videoArea"></div>
        <div id="msg"></div>

	<script src="cordova.js"></script>
	<script>

    document.addEventListener("deviceready", init, false);

	function init() {
		document.querySelector("#takeVideo").addEventListener("touchend", takeVideo, false);
	}

    function takeVideo() {
        console.log("You are allowed 15 seconds to record the video");
        navigator.notification.alert('You are allowed 15 seconds to record the video', captureVideo, 'Alert', 'OK');
    }

	function captureVideo() {
		var options = {
            limit: 1,   // Max number of video clips in a single capture operation
            duration: 15,    // Max duration of each video clip
            quality: 1  // 0 means low quality, 1 means high quality
        };
		navigator.device.capture.captureVideo(captureSuccess, captureError, options);
	}

	function captureError(err) {
        console.log("Failed to record video " + JSON.stringify(err));
        navigator.notification.alert('Failed to record video: ' + err, null, 'Error', 'OK');
        document.querySelector('#videoArea').innerHTML = "";
        document.getElementById('msg').textContent = "No video recorded";
	}

	function captureSuccess(s) {
        console.log("Video successfully recorded");
        var v = "<video width=\"400\" height=\"300\" controls>";
            v += "<source src='" + s[0].fullPath + "' type='video/mp4'>";
            v += "</video>";
        document.querySelector('#videoArea').innerHTML = v;
        navigator.notification.confirm('Video successfully recorded', null, 'Success', ['OK']);
        document.querySelector('#msg').textContent = "Video stored at: " + s[0].fullPath;
	}

    </script>
	</body>
</html>
